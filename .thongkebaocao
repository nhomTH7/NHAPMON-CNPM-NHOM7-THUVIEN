import sqlite3
from tabulate import tabulate

# K·∫øt n·ªëi database
conn = sqlite3.connect("library.db")
cursor = conn.cursor()


def report_most_borrowed_books():
    query = """
        SELECT s.MaSach, s.TenSach, COUNT(mt.MaSach) AS SoLanMuon
        FROM MuonTra mt
        JOIN Sach s ON mt.MaSach = s.MaSach
        GROUP BY s.MaSach, s.TenSach
        ORDER BY SoLanMuon DESC
        LIMIT 10;
    """
    cursor.execute(query)
    result = cursor.fetchall()
    print("\nüìå B√°o c√°o s√°ch ƒë∆∞·ª£c m∆∞·ª£n nhi·ªÅu nh·∫•t:")
    print(tabulate(result, headers=["M√£ s√°ch", "T√™n s√°ch", "S·ªë l·∫ßn m∆∞·ª£n"], tablefmt="github"))